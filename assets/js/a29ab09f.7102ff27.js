"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[158],{66409:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>p,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>s});var l=n(87462),a=(n(67294),n(3905)),r=n(61839);const i={slug:"/"},p="Flutter Primer",o={unversionedId:"flutter-primer",id:"flutter-primer",title:"Flutter Primer",description:"\u5b89\u88c5",source:"@site/docs/flutter/flutter-primer.md",sourceDirName:".",slug:"/",permalink:"/docs/flutter/",draft:!1,tags:[],version:"current",frontMatter:{slug:"/"},sidebar:"tutorialSidebar",previous:{title:"Flutter News",permalink:"/docs/flutter/flutter-news"},next:{title:"Flutter Principle",permalink:"/docs/flutter/flutter-principle"}},u={},s=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u65b0\u5efa\u9879\u76ee",id:"\u65b0\u5efa\u9879\u76ee",level:2},{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:2},{value:"AS \u5feb\u6377\u952e",id:"as-\u5feb\u6377\u952e",level:2},{value:"Platform Channel",id:"platform-channel",level:2},{value:"\u673a\u5236",id:"\u673a\u5236",level:3},{value:"\u6570\u636e\u7c7b\u578b",id:"\u6570\u636e\u7c7b\u578b",level:3},{value:"Dart packages and Plugin packages",id:"dart-packages-and-plugin-packages",level:2},{value:"Dart packages",id:"dart-packages",level:3},{value:"Plugin packages",id:"plugin-packages",level:3},{value:"Package \u7684\u5b89\u88c5\u4f4d\u7f6e",id:"package-\u7684\u5b89\u88c5\u4f4d\u7f6e",level:2},{value:"\u4f7f\u7528 Package",id:"\u4f7f\u7528-package",level:2},{value:"Add-to-app",id:"add-to-app",level:2},{value:"Project setup",id:"project-setup",level:3},{value:"Adding a Flutter screen to an iOS app",id:"adding-a-flutter-screen-to-an-ios-app",level:3},{value:"Flutter Tools",id:"flutter-tools",level:2},{value:"Plugin",id:"plugin",level:2},{value:"\u5168\u5bb6\u6876",id:"\u5168\u5bb6\u6876",level:2}],d={toc:s};function c(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,l.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"flutter-primer"},"Flutter Primer"),(0,a.kt)("h2",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://flutter.dev/docs/get-started/install/macos"},"macOS install")),(0,a.kt)("p",null,"\u4e0b\u8f7d\u5b89\u88c5 Flutter\uff0c\u7136\u540e\uff0c\u5c06\u8fd9\u4e2a\u6587\u4ef6\u5939\u52a0\u5230 $PATH \u4e2d\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'export PATH="$HOME/Documents/flutter/bin:$PATH"\n')),(0,a.kt)("p",null,"\u7136\u540e\uff0c\u8fd0\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter doctor"),"\uff0cflutter \u4f1a\u4e0b\u8f7d\u4e00\u7cfb\u5217\u76f8\u5173\u7684 SDK\u3002"),(0,a.kt)("p",null,"\u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"~/.pub-cache/hosted/pub.dartlang.org")," \u6587\u4ef6\u5939\u4e0b\u4f1a\u591a\u4e86\u5f88\u591a pub packages\uff0c\u6211\u4eec\u5f00\u53d1\u7684 flutter \u5de5\u7a0b\u6240\u5b89\u88c5\u7684 pub\uff0c\u90fd\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7f13\u5b58\u3002"),(0,a.kt)("p",null,"\u6b64\u5916\uff0c\u5982\u679c\u6709\u81ea\u5b9a\u4e49\u7684 pub package \u6e90\uff0c\u4e5f\u4f1a\u51fa\u73b0\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"~/.pub-cache/hosted/")," \u4e0b\u9762\uff0c\u4ee5\u57df\u540d\u547d\u540d\u7684\u6587\u4ef6\u5939\u3002"),(0,a.kt)("p",null,"\u540c\u65f6\uff0c\u65b0\u589e\u4e86 ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin/cache"),"\uff0cTODO: \u8fd9\u4e9b\u7f13\u5b58\u7684\u4f5c\u7528\u3002"),(0,a.kt)("h2",{id:"\u65b0\u5efa\u9879\u76ee"},"\u65b0\u5efa\u9879\u76ee"),(0,a.kt)("p",null,"\u5728\u547d\u4ee4\u884c\u76f4\u63a5\u521b\u5efa\u65b0\u9879\u76ee\uff0c\u9ed8\u8ba4\u539f\u751f\u8bed\u8a00\u662f kotlin \u548c swift\uff0c\u4f7f\u7528 objc \u548c java \u9700\u8981\u4f20\u53c2\u3002"),(0,a.kt)("p",null,"\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a flutter \u9879\u76ee\uff0c\u5b83\u4e3b\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u662f\u83b7\u53d6\u539f\u751f\u7aef\u7535\u6c60\u7684\u7535\u91cf\uff0c\u9879\u76ee\u540d\u79f0\u53ea\u80fd\u5c0f\u5199\uff08\u6709\u5927\u5199\u5b57\u6bcd\u4f1a\u62a5\u9519\uff09\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"flutter create -i objc -a java battery_level\n")),(0,a.kt)("h2",{id:"\u5e38\u7528\u547d\u4ee4"},"\u5e38\u7528\u547d\u4ee4"),(0,a.kt)("p",null,"p: debug painting, see the wireframe for each widget"),(0,a.kt)("p",null,"\u6216\u8005\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/rendering.dart';\n\nvoid main() {\n  debugPaintSizeEnabled = true;\n  runApp(MyApp());\n}\n")),(0,a.kt)("p",null,"\u6216\u8005 Flutter inspector - Debugging layout issues visually"),(0,a.kt)("p",null,"r: hot reload"),(0,a.kt)("p",null,"R: restart"),(0,a.kt)("p",null,"\u5bf9\u4e8e iOS \u5f00\u53d1\u8005\uff0c\u6539\u52a8\u4e86\u539f\u751f\u4ee3\u7801\uff0c\u53ef\u4ee5\u5148\u5728 Xcode \u628a flutter \u8fd0\u884c\u8d77\u6765\uff0c\u7136\u540e\u5728\u547d\u4ee4\u884c\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter attach")," \u8fde\u63a5\u8c03\u8bd5\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"flutter devices")," \u67e5\u770b\u53ef\u8fde\u63a5\u7684\u8bbe\u5907"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"flutter attach -d 37399F6A-35C4-4ED8-B460-D6E0C043EBAF")," \u6307\u5b9a\u8bbe\u5907\u8fde\u63a5"),(0,a.kt)("h2",{id:"as-\u5feb\u6377\u952e"},"AS \u5feb\u6377\u952e"),(0,a.kt)("p",null,"\u5b9a\u4f4d\u5230\u5f53\u524d\u6587\u4ef6\uff1aSelect Opened File \u6216\u8005\u9009\u62e9 Always Select Opened File"),(0,a.kt)("p",null,"\u6587\u4ef6\u5bfc\u822a\u540e\u9000\u524d\u8fdb\uff1aCommand + Option + Left/Right"),(0,a.kt)("p",null,"Reformat code: Command + Option + L"),(0,a.kt)("h2",{id:"platform-channel"},"Platform Channel"),(0,a.kt)("p",null,"\u5982\u4f55\u4ece dart \u4ee3\u7801\u8c03\u7528\u5230 native\uff1f",(0,a.kt)("a",{parentName:"p",href:"https://flutter.dev/docs/development/platform-integration/platform-channels"},"Writing custom platform-specific code")),(0,a.kt)("p",null,"\u7b2c\u4e00\u6b65\uff0cdart \u4ee3\u7801\u58f0\u660e\u4e00\u4e2a channel\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"static const platform = MethodChannel('samples.flutter.dev/battery');")),(0,a.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff0cdart \u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"await platform.invokeMethod('getBatteryLevel');")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart",metastring:"title='my_homepage.dart'",title:"'my_homepage.dart'"},"class _MyHomePageState extends State<MyHomePage> {\n  String _batteryLevel = '';\n\n  static const platform = MethodChannel('samples.flutter.dev/battery');\n\n  Future<void> _getBatteryLevel() async {\n    String batteryLevel;\n    try {\n      final int result = await platform.invokeMethod('getBatteryLevel');\n      batteryLevel = 'Battery level at $result % .';\n    } on PlatformException catch (e) {\n      batteryLevel = \"Failed to get battery level: '${e.message}'.\";\n    }\n    setState(() {\n      _batteryLevel = batteryLevel;\n    });\n  }\n}\n")),(0,a.kt)("p",null,"\u7b2c\u4e09\u6b65\uff0c\u539f\u751f\u5b9e\u73b0"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-objc",metastring:"title='MyFlutterViewController.m'",title:"'MyFlutterViewController.m'"},'- (void)viewDidLoad {\n    [super viewDidLoad];\n\n    FlutterMethodChannel *batteryChannel = [FlutterMethodChannel methodChannelWithName:@"samples.flutter.dev/battery" binaryMessenger:self.binaryMessenger];\n    __weak typeof(self) weakSelf = self;\n    [batteryChannel setMethodCallHandler:^(FlutterMethodCall *call, FlutterResult result) {\n        // Note: this method is invoked on the UI thread.\n        __strong typeof(weakSelf) strongSelf = weakSelf;\n        if (![strongSelf canHandleMethod:call.method]) {\n            result(FlutterMethodNotImplemented); // \u8bb0\u5f97\u7ed9flutter\u56de\u8c03\uff0c\u4e0d\u7136await\u540e\u9762\u7684\u4e0d\u4f1a\u6267\u884c\u4e86\n            return;\n        }\n        int batteryLevel = [weakSelf getBatteryLevel];\n        if (batteryLevel == -1) {\n            result([FlutterError errorWithCode:@"UNAVAILABLE"\n                                       message:@"Battery info unavailable"\n                                       details:nil]);\n        } else {\n            result(@(batteryLevel));\n        }\n    }];\n}\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"binaryMessenger")," \u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterViewController")," \u7684\u5c5e\u6027\uff0c\u5b9e\u9645\u53d6\u7684\u662f\u5f15\u64ce\u7684 binary messenger\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-objc"},"/**\n * The `FlutterBinaryMessenger` associated with this FlutterViewController (used for communicating\n * with channels).\n *\n * This is just a convenient way to get the |FlutterEngine|'s binary messenger.\n */\n@property(nonatomic, readonly) NSObject<FlutterBinaryMessenger>* binaryMessenger;\n")),(0,a.kt)("h3",{id:"\u673a\u5236"},"\u673a\u5236"),(0,a.kt)("p",null,"Messages are passed between the ",(0,a.kt)("strong",{parentName:"p"},"client")," (UI, \u4e5f\u5c31\u662f dart \u4ee3\u7801\u90a3\u4e00\u5c42) and ",(0,a.kt)("strong",{parentName:"p"},"host")," (platform, \u4e5f\u5c31\u662f\u539f\u751f\u4ee3\u7801\u90a3\u4e00\u5c42) using platform channels."),(0,a.kt)("p",null,"The client sends messages to its host. The host listens on the platform channel, and receives the message."),(0,a.kt)("p",null,"Messages and responses are passed asynchronously, to ensure the user interface remains responsive."),(0,a.kt)("p",null,"You must invoke a channel method on the platform\u2019s main thread."),(0,a.kt)("p",null,"If desired, method calls can also be sent in the reverse direction, with the platform acting as client to methods implemented in Dart. \u539f\u751f\u7aef\u4e5f\u53ef\u4ee5\u8c03\u7528 dart \u5c42\u4ee3\u7801\u3002"),(0,a.kt)("p",null,"\u539f\u751f\u8c03\u7528 dart\uff0c\u8981\u5728\u4e3b\u7ebf\u7a0b\uff1aWhen invoking channels on the platform side destined for Flutter, they need to be invoked on the platform\u2019s main thread."),(0,a.kt)("p",null,"dart \u8c03\u7528\u539f\u751f\uff0c\u8981\u5728 root Isolate\uff1aWhen invoking channels in Flutter destined for the platform side, they need to be invoked on the root Isolate."),(0,a.kt)("h3",{id:"\u6570\u636e\u7c7b\u578b"},"\u6570\u636e\u7c7b\u578b"),(0,a.kt)("p",null,"Dart \u6570\u636e\u7c7b\u578b\u5bf9\u5e94\u5e73\u53f0\u7684\u6570\u636e\u7c7b\u578b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.flutter.dev/development/platform-integration/platform-channels?tab=type-mappings-obj-c-tab#codec"},"https://docs.flutter.dev/development/platform-integration/platform-channels?tab=type-mappings-obj-c-tab#codec")),(0,a.kt)("h2",{id:"dart-packages-and-plugin-packages"},"Dart packages and Plugin packages"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://flutter.dev/docs/development/packages-and-plugins/developing-packages"},"Developing packages & plugins")),(0,a.kt)("p",null,"packages \u53ef\u4ee5\u662f\u7eaf dart \u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u5305\u542b\u5bf9\u539f\u751f\u7684\u8c03\u7528\uff0c\u8c03\u7528\u4e86\u539f\u751f\u7684\u8bdd flutter \u79f0\u4e4b\u4e3a plugin\u3002"),(0,a.kt)("p",null,"\u5982\u4f55\u533a\u5206\u4e00\u4e2a package \u662f dart \u8fd8\u662f plugin\uff1f\u770b\u5b83\u76ee\u5f55\u4e0b\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.yml")," \u6587\u4ef6\uff0c\u5982\u679c\u662f plugin \u7684\u8bdd\u4f1a\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"plugin")," \u5b57\u6bb5\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"flutter:\n  # This section identifies this Flutter project as a plugin project.\n  plugin:\n    platforms:\n      android:\n        package: com.yianzhou.hello\n        pluginClass: HelloPlugin\n      ios:\n        pluginClass: HelloPlugin\n")),(0,a.kt)("h3",{id:"dart-packages"},"Dart packages"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u4ee5\uff08\u4e1a\u52a1\u7684\uff09\u9875\u9762\u5f00\u53d1\u4e3a\u5355\u4f4d\uff0c\u6bcf\u4e2a\u9875\u9762\u4e00\u4e2a package\uff0c\u9875\u9762\u4e4b\u95f4\u5b8c\u5168\u9694\u79bb\u3002"),(0,a.kt)("p",null,"\u65b0\u5efa dart packages\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"flutter create --template=package welcome")),(0,a.kt)("p",null,"\u5728\u4e3b\u5de5\u7a0b\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.yml")," \u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"dependencies")," \u5f15\u7528\u8fd9\u4e2a package:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},'dependencies:\n  welcome:\n    path: "welcome/"\n')),(0,a.kt)("p",null,"\u7136\u540e\u5728 dart \u4ee3\u7801\u4e2d\u5f15\u5165\u8fd9\u4e2a package \u5c31\u53ef\u4ee5\u8c03\u7528\u3002"),(0,a.kt)("h3",{id:"plugin-packages"},"Plugin packages"),(0,a.kt)("p",null,"\u6240\u8c13 plugin\uff0c\u4e0d\u8fc7\u662f\u6709\u539f\u751f\u4ee3\u7801\u7684 package \u800c\u5df2\uff0c\u4e5f\u662f\u901a\u8fc7\u524d\u9762\u6240\u8bb2\u7684 FlutterMethodChannel \u6765\u5b9e\u73b0 dart \u5bf9\u539f\u751f\u7684\u8c03\u7528\uff0c\u6ca1\u4ec0\u4e48\u7279\u522b\u7684\u3002"),(0,a.kt)("p",null,"\u65b0\u5efa plugin packages\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"flutter create --org com.yianzhou --template=plugin --platforms=android,ios -i objc -a java hello\n")),(0,a.kt)("p",null,"\u65b0\u5efa\u597d plugin packages \u540e\uff0c\u91cc\u9762\u6709 examples/ \u6587\u4ef6\u5939\uff0c\u9996\u5148\u8981\u505a\u7684\u662f\u5728 Xcode \u4e2d\u628a example \u8dd1\u8d77\u6765\u3002"),(0,a.kt)("p",null,"\u5f00\u53d1 plugin\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"dart \u4ee3\u7801\u4f4d\u4e8e ",(0,a.kt)("inlineCode",{parentName:"li"},"hello/lib/hello.dart")),(0,a.kt)("li",{parentName:"ul"},"iOS \u4ee3\u7801\u4f4d\u4e8e ",(0,a.kt)("inlineCode",{parentName:"li"},"hello/ios/Classes/HelloPlugin.m"))),(0,a.kt)("p",null,"\u5c06 plugin \u5f15\u5165\u4e3b\u5de5\u7a0b\u2014\u2014\u5728\u4e3b\u5de5\u7a0b\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.yml")," \u6587\u4ef6\uff0c\u52a0\u5165 plugin \u7684\u58f0\u660e\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},'dependencies:\n  hello:\n    path: "hello/"\n')),(0,a.kt)("p",null,"\u8fd0\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter pub get")," \u4e4b\u540e\uff0c\u4f1a\u81ea\u52a8\u751f\u6210 ",(0,a.kt)("inlineCode",{parentName:"p"},"ios/Runner/GeneratedPluginRegistrant.m")," \u6587\u4ef6\uff0c\u6240\u6709\u7684 plugin \u4f1a\u5728\u8fd9\u4e2a\u81ea\u52a8\u751f\u6210\u7684\u7c7b\u91cc\u6ce8\u518c\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-objc",metastring:"title='GeneratedPluginRegistrant.m'",title:"'GeneratedPluginRegistrant.m'"},'+ (void)registerWithRegistry:(NSObject<FlutterPluginRegistry>*)registry {\n  [HelloPlugin registerWithRegistrar:[registry registrarForPlugin:@"HelloPlugin"]];\n}\n')),(0,a.kt)("p",null,"\u5982\u679c\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.yml")," \u6587\u4ef6\u91cc\u6ca1\u6709\u58f0\u660e\u4efb\u4f55 plugin\uff0c\u90a3 ",(0,a.kt)("inlineCode",{parentName:"p"},"registerWithRegistry:")," \u4f1a\u662f\u7a7a\u5b9e\u73b0\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"HelloPlugin")," \u8fd9\u4e2a\u540d\u5b57\u5c31\u662f\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"hello/pubspec.yml")," \u91cc\u9762\u58f0\u660e\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"pluginClass"),"\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f ",(0,a.kt)("inlineCode",{parentName:"p"},"AppDelegate.m"),"\uff0c\u5f53\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a flutter \u5de5\u7a0b\u65f6\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4ee5\u4e0b\u7684\u4ee3\u7801\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-objc",metastring:"title='AppDelegate.m'",title:"'AppDelegate.m'"},"- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {\n  [GeneratedPluginRegistrant registerWithRegistry:self]; // \u5728\u8fd9\u91cc\u6ce8\u518c\u6240\u6709\u7684 plugin\n  return [super application:application didFinishLaunchingWithOptions:launchOptions];\n}\n")),(0,a.kt)("p",null,"\u5982\u679c\u9700\u8981\u4f9d\u8d56\u5176\u5b83\u7b2c\u4e09\u65b9 pod\uff0c\u5219\u52a0\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"hello/ios/hello.podspec")," \u91cc\u9762\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rb"},"s.dependency 'SDWebImage'\n")),(0,a.kt)("h2",{id:"package-\u7684\u5b89\u88c5\u4f4d\u7f6e"},"Package \u7684\u5b89\u88c5\u4f4d\u7f6e"),(0,a.kt)("p",null,"\u4ee5 ",(0,a.kt)("a",{parentName:"p",href:"https://pub.dev/packages/local_auth"},"local_auth")," \u4e3a\u4f8b\uff0c\u5728\u4e3b\u5de5\u7a0b ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.yaml")," \u6dfb\u52a0\u4f9d\u8d56\u540e\uff0c\u8fd0\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter pub get"),"\uff0c\u7136\u540e\u6253\u5f00 ios \u539f\u751f\u5de5\u7a0b\u6267\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"pod install"),"\uff0clocal_auth \u7684\u539f\u751f\u4ee3\u7801\u90e8\u5206\u662f\u901a\u8fc7 Development Pods \u7684\u65b9\u5f0f\u96c6\u6210\u5230\u5de5\u7a0b\u91cc\uff0c\u5e76\u901a\u8fc7 symlinks \u7684\u65b9\u5f0f\uff0c\u8f6f\u94fe\u63a5\u5230\u4ee5\u4e0b\u4f4d\u7f6e\uff1a"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"~/.pub-cache/hosted/pub.dartlang.org/local_auth-1.1.10/ios/Classes/")),(0,a.kt)("h2",{id:"\u4f7f\u7528-package"},"\u4f7f\u7528 Package"),(0,a.kt)("p",null,"\u5b89\u88c5\u6162\u7684\u89e3\u51b3\u65b9\u6cd5\uff1a\u5b98\u65b9\u6559\u7a0b\u6709\u6307\u5bfc ",(0,a.kt)("a",{parentName:"p",href:"https://flutter.dev/community/china"},"Using Flutter in China")),(0,a.kt)("p",null,"\u5728 shell \u4e2d\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff0c\u518d\u8fd0\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter pub get")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"export PUB_HOSTED_URL=https://pub.flutter-io.cn\nexport FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn\n")),(0,a.kt)("p",null,"\u5982\u4f55\u6307\u5b9a\u7248\u672c You can express version constraints using either caret syntax (^1.2.3) or traditional syntax ('>=1.2.3 <2.0.0')."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"dependencies:\n  ## version range with caret syntax, any 5.4.x version where x >= 0 works.\n  url_launcher: ^5.4.0\n\n  ## version range with traditional syntax\n  url_launcher: '>=5.4.0 <6.0.0'\n\n  ## \u6307\u5b9a\u5230\u6587\u4ef6\u7cfb\u7edf\u7684\u8def\u5f84\uff0c\u8fd9\u4e2a\u8def\u5f84\u4e0b\u6709 pubspec.yaml \u6587\u4ef6\n  plugin1:\n    path: ../plugin1/\n\n  ## \u6307\u5b9a\u5230 git \u4ed3\u5e93\n  plugin2:\n    git:\n      url: git://github.com/flutter/plugin1.git ## the Git URL that can be used to clone the package.\n      path: packages/some_package ## git \u4ed3\u5e93\u4e0b\u7684\u8def\u5f84\n      ref: some-branch ## depend on a specific commit, branch, tag, or anything that Git allows to identify a commit.\n\n  ## \u81ea\u5df1\u6307\u5b9a\u4e00\u4e2a\u6e90\uff08\u4e0d\u6307\u5b9a\u7684\u8bdd\uff0c\u9ed8\u8ba4\u4f7f\u7528 pub.dev \u6e90\uff09\n  transmogrify:\n    hosted:\n      name: transmogrify\n      url: http://some-package-server.com\n    version: ^1.0.0\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},".lock")," \u6587\u4ef6\u7684\u4f5c\u7528\uff1aWhen running ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter pub get")," for the first time after adding a package, Flutter saves the concrete package version found in the ",(0,a.kt)("inlineCode",{parentName:"p"},"pubspec.lock")," lockfile. This ensures that you get the same version again if you, or another developer on your team, run flutter pub get."),(0,a.kt)("p",null,"If it\u2019s only imported from test, example, etc. it can and should be a dev dependency."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'dev_dependencies:\n  plugin1: ">=0.5.0 <0.12.0"\n')),(0,a.kt)("p",null,"\u7248\u672c\u51b2\u7a81\uff1a\u5982\u679c\u4e24\u4e2a package \u540c\u65f6\u4f9d\u8d56\u4e86 url_launcher\uff0c\u800c\u4ed6\u4eec\u6307\u5b9a\u7684\u7248\u672c\u53c8\u4e0d\u4e00\u6837\u7684\u8bdd\uff0c\u5c31\u4f1a\u53d1\u751f\u7248\u672c\u51b2\u7a81\u3002\u53ef\u4ee5\u901a\u8fc7 dependency override \u89e3\u51b3\u3002"),(0,a.kt)("h2",{id:"add-to-app"},"Add-to-app"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.flutter.dev/development/add-to-app"},"Add Flutter to existing app | Flutter")),(0,a.kt)("p",null,"Add-to-app supports adding multiple instances of Flutter engines, screens, or views into your app."),(0,a.kt)("h3",{id:"project-setup"},"Project setup"),(0,a.kt)("p",null,"\u5728\u539f\u751f\u5de5\u7a0b\u7684",(0,a.kt)("strong",{parentName:"p"},"\u7236\u7ea7\u76ee\u5f55"),"\u4e0b\u8fd0\u884c\u547d\u4ee4\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"flutter create --template module my_flutter"),"\uff0c\u5f62\u6210 iOS\u3001Android\u3001Flutter module \u540c\u7ea7\u7684\u76ee\u5f55\u7ed3\u6784\u3002"),(0,a.kt)("p",null,"\u521b\u5efa\u597d\u540e\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"my_flutter/")," \u8fd9\u4e2a\u6587\u4ef6\u5939\u548c\u4e00\u822c\u7684 flutter \u5de5\u7a0b\u65e0\u5f02\uff0c\u53ef\u4ee5\u5355\u72ec ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter run")," \u6216 ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter build ios"),"\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},".ios/")," \u8fd9\u4e2a\u9690\u85cf\u7684\u6587\u4ef6\u5939\u662f\u81ea\u52a8\u751f\u6210\u7684\uff0c\u4e0d\u8981\u4fee\u6539\u91cc\u9762\u7684\u4e1c\u897f\uff0c\u4e5f\u4e0d\u8981\u628a\u5b83\u52a0\u5230\u7248\u672c\u63a7\u5236\u91cc\u3002"),(0,a.kt)("p",null,"\u7528 CocoaPods \u96c6\u6210\u8981\u6c42\u56e2\u961f\u6240\u6709\u6210\u5458\u7684\u7535\u8111\u91cc\u90fd\u6709 Flutter SDK\u3002"),(0,a.kt)("p",null,"\u9996\u5148\uff0c\u5728\u539f\u751f\u5de5\u7a0b\u7684 Podfile \u4e2d\u6dfb\u52a0\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rb"},"flutter_application_path = 'my_flutter'\nload File.join(flutter_application_path, '.ios', 'Flutter', 'podhelper.rb')\n\ntarget 'MyApp' do\n  install_all_flutter_pods(flutter_application_path)\nend\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"File.join"),' \u5c31\u662f\u628a\u5165\u53c2\u7684\u51e0\u4e2a\u5b57\u7b26\u4e32\u7528 "/" \u62fc\u6210\u6587\u4ef6\u8def\u5f84\uff1b',(0,a.kt)("inlineCode",{parentName:"p"},"load")," \u5c31\u662f\u52a0\u8f7d\u5e76\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\u7684\u4ee3\u7801\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\u8fd9\u91cc\u7684\u610f\u601d\u5c31\u662f\u8f7d\u5165 ",(0,a.kt)("inlineCode",{parentName:"p"},"my_flutter/.ios/Flutter/podhelper.rb")," \u8fd9\u4e2a\u6587\u4ef6\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"install_all_flutter_pods")," \u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"podhelper.rb")," \u8fd9\u4e2a\u6587\u4ef6\u91cc\u5b9a\u4e49\u7684\u51fd\u6570\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u6bcf\u6b21\u4fee\u6539 ",(0,a.kt)("inlineCode",{parentName:"p"},"my_flutter/pubspec.yaml")," \u6587\u4ef6\u540e\uff0crun ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter pub get")," to refresh the list of plugins read by the ",(0,a.kt)("inlineCode",{parentName:"p"},"podhelper.rb")," script. Then, run ",(0,a.kt)("inlineCode",{parentName:"p"},"pod install")," again."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"podhelper.rb")," script embeds your plugins, ",(0,a.kt)("inlineCode",{parentName:"p"},"Flutter.framework"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"App.framework")," into your project."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Flutter.framework")," is the bundle for the Flutter engine, and ",(0,a.kt)("inlineCode",{parentName:"p"},"App.framework")," is the compiled Dart code for this project."),(0,a.kt)("h3",{id:"adding-a-flutter-screen-to-an-ios-app"},"Adding a Flutter screen to an iOS app"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://docs.flutter.dev/development/add-to-app/ios/add-flutter-screen"},"Adding a Flutter screen to an iOS app | Flutter")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u628a flutter \u5f15\u64ce\u52a0\u8fdb\u6765\uff0c\u5e76\u8fd0\u884c\u8d77\u6765\uff08\u901a\u5e38\u662f\u5728 ",(0,a.kt)("inlineCode",{parentName:"li"},"AppDelegate"),"\uff09"),(0,a.kt)("li",{parentName:"ol"},"\u5c55\u793a\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"li"},"FlutterViewController"))),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterEngine")," serves as a host to the Dart VM and your Flutter runtime, and the ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterViewController")," attaches to a ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterEngine")," to pass UIKit input events into Flutter and to display frames rendered by the ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterEngine"),"."),(0,a.kt)("p",null,"It\u2019s generally recommended to pre-warm a long-lived ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterEngine")," for your application because:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The first frame appears faster when showing the ",(0,a.kt)("inlineCode",{parentName:"li"},"FlutterViewController"),"."),(0,a.kt)("li",{parentName:"ul"},"Your Flutter and Dart state will outlive one ",(0,a.kt)("inlineCode",{parentName:"li"},"FlutterViewController"),"."),(0,a.kt)("li",{parentName:"ul"},"Your application and your plugins can interact with Flutter and your Dart logic before showing the UI.")),(0,a.kt)("p",null,"If your app delegate can\u2019t directly make ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterAppDelegate")," a subclass, make your app delegate implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterAppLifeCycleProvider")," protocol in order to make sure your plugins receive the necessary callbacks."),(0,a.kt)("p",null,"\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0cflutter \u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"main()")," \u4f1a\u5728\u6211\u4eec\u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"[self.flutterEngine run]")," \u65f6\u6267\u884c\u3002"),(0,a.kt)("p",null,"Calling ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," on a ",(0,a.kt)("inlineCode",{parentName:"p"},"FlutterEngine"),", by default, runs the ",(0,a.kt)("inlineCode",{parentName:"p"},"main()")," Dart function of your ",(0,a.kt)("inlineCode",{parentName:"p"},"lib/main.dart")," file. You can also run a different entrypoint function by using ",(0,a.kt)("inlineCode",{parentName:"p"},"runWithEntrypoint")," with an ",(0,a.kt)("inlineCode",{parentName:"p"},"NSString")," specifying a different Dart function."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'flutterEngine.run(withEntrypoint: FlutterDefaultDartEntrypoint, initialRoute: "/onboarding")'),' This code sets your dart:ui\u2019s window.defaultRouteName to "/onboarding" instead of "/".'),(0,a.kt)("p",null,"In order to imperatively change your current Flutter route from the platform side after the FlutterEngine is already running, use ",(0,a.kt)("inlineCode",{parentName:"p"},"pushRoute()")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"popRoute()")," on the FlutterViewController."),(0,a.kt)("p",null,"To pop the iOS route from the Flutter side, call ",(0,a.kt)("inlineCode",{parentName:"p"},"SystemNavigator.pop()"),"."),(0,a.kt)("h2",{id:"flutter-tools"},"Flutter Tools"),(0,a.kt)("p",null,"\u6211\u4eec\u5728\u547d\u4ee4\u884c\u4f7f\u7528\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter")," \u6307\u4ee4\uff0c\u4f4d\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin")," \u8def\u5f84\u4e0b\u3002\u67e5\u770b\u5176\u6e90\u7801\uff0c\u53d1\u73b0\u5176\u6267\u884c\u7684\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin/internal/shared.sh"),"\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u6267\u884c\u4ee3\u7801\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'"$DART" --disable-dart-dev --packages="$FLUTTER_TOOLS_DIR/.packages" $FLUTTER_TOOL_ARGS "$SNAPSHOT_PATH" "$@"\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"$DART")," \u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin/cache/dart-sdk/bin/dart"),"\uff1b"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"$SNAPSHOT_PATH")," \u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin/cache/flutter_tools.snapshot"),"\uff0c\u8fd9\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter/packages/flutter_tools")," \u9879\u76ee\u7f16\u8bd1\u7684\u4ea7\u7269\u3002"),(0,a.kt)("p",null,"\u5c06 ",(0,a.kt)("inlineCode",{parentName:"p"},'"$SNAPSHOT_PATH"')," \u6539\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},'"$FLUTTER_ROOT/packages/flutter_tools/bin/flutter_tools.dart"'),"\uff0c\u518d\u8fd0\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter")," \u547d\u4ee4\u5c31\u4f1a\u6267\u884c\u672c\u5730 flutter_tools \u9879\u76ee\u7684\u4ee3\u7801\u3002"),(0,a.kt)("h2",{id:"plugin"},"Plugin"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"img",src:n(70854).Z,width:"1241",height:"695"})),(0,a.kt)(r.G,{chart:"classDiagram\n  class FlutterPluginRegistry~NSObject~ {\n    <<protocol>>\n    \u767b\u8bb0\u5904\n    -(NSObject<FlutterPluginRegistrar>*)registrarForPlugin:(NSString*)pluginKey;\n    -(BOOL)hasPlugin:(NSString*)pluginKey;\n    -(NSObject*)valuePublishedByPlugin:(NSString*)pluginKey;\n  }\n  class FlutterPluginRegistrar~NSObject~ {\n    <<protocol>>\n    \u767b\u8bb0\u5904\u4e3b\u4efb\n    -(NSObject<FlutterBinaryMessenger>*)messenger;\n    -(NSObject<FlutterTextureRegistry>*)textures;\n    -(void)registerViewFactory:(NSObject<FlutterPlatformViewFactory>*)factory withId:(NSString*)factoryId;\n  }\n  class FlutterPlugin~FlutterApplicationLifeCycleDelegate~ {\n    \u767b\u8bb0\u4eba\n    <<protocol>>\n    +(void)registerWithRegistrar:(NSObject<FlutterPluginRegistrar>*)registrar;\n    +(void)setPluginRegistrantCallback:(FlutterPluginRegistrantCallback)callback;\n    -(void)handleMethodCall:(FlutterMethodCall*)call result:(FlutterResult)result;\n  }\n  FlutterPluginRegistry -- FlutterPluginRegistrar\n  FlutterPluginRegistrar -- FlutterPlugin",mdxType:"Mermaid"}),(0,a.kt)("h2",{id:"\u5168\u5bb6\u6876"},"\u5168\u5bb6\u6876"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/flutter/flutter"},"https://github.com/flutter/flutter")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/flutter/engine"},"https://github.com/flutter/engine")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/dart-lang/sdk"},"https://github.com/dart-lang/sdk")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/google/skia"},"https://github.com/google/skia"))),(0,a.kt)("p",null,"dSYM: ",(0,a.kt)("a",{parentName:"p",href:"https://storage.cloud.google.com/flutter_infra_release/flutter/6ba2af10bb05c88a2731482cedf2cfd11cf5af0b/ios-release/Flutter.dSYM.zip"},"https://storage.cloud.google.com/flutter_infra_release/flutter/6ba2af10bb05c88a2731482cedf2cfd11cf5af0b/ios-release/Flutter.dSYM.zip")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"flutter/bin/internal/engine.version")," \u67e5\u770b hash\uff0c\u628a\u4e0a\u9762\u94fe\u63a5\u7684 hash \u66ff\u6362\u6210\u5f53\u524d flutter \u7248\u672c\u7684 hash\u3002"),(0,a.kt)("p",null,"\u6216\u8005\u6253\u5f00 ",(0,a.kt)("inlineCode",{parentName:"p"},"Flutter.framework")," \u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"Info.plist"),"\uff0c\u4e5f\u53ef\u4ee5\u770b\u5230 engine \u7248\u672c\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"engine/DEPS")," \u8fd9\u4e2a\u6587\u4ef6\u8bb0\u5f55\u4e86\u5f15\u64ce\u7528\u7684 dart \u7248\u672c\u3001skia \u7248\u672c\u7b49\u4fe1\u606f\u3002"))}c.isMDXComponent=!0},70854:(e,t,n)=>{n.d(t,{Z:()=>l});const l=n.p+"assets/images/DA67EEDC-0618-4864-91BD-2219B3131294-8e4855a943bb49f3ef918812c1527073.png"}}]);